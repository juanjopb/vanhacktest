---
- name: "Deploy AWS insfrastructure"
  hosts: localhost
  connection: local
  gather_facts: yes
  roles:
   - AWSinfrastructure

- name: "Deploy Flask on Ec2 instance"
  hosts: ec2_instance_ips
  become: yes
  become_method: sudo
  remote_user: ubuntu
  gather_facts: no
  roles:
   - flask

- name: "Spin Up ELB and add Servers"
  hosts: localhost
  connection: local
  gather_facts: yes
  roles:
    - AWSelb

- name: General Information of AWS Infrastructure Deployed
  debug:
    msg:
      - "Instances : {{ ec2_web.tagged_instances }}"
      - "URL Endpoint: {{ elb.elb.dns_name }}"
  